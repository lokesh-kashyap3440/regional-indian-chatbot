services:
  - type: web
    name: rag-grok
    runtime: node
    rootDir: .
    buildCommand: npm install && cd client && npm install --include=dev && npm run build
    startCommand: node server/index.js
    plan: free               # change to 'starter' or higher for paid tier
    envVars:
      - key: NODE_ENV
        value: production
      - key: HF_API_KEY
        sync: false          # set manually in Render dashboard
      - key: XAI_API_KEY
        sync: false          # set manually in Render dashboard
      - key: XAI_EMBEDDING_DIM
        value: "384"         # default; change if using a different model
      - key: XAI_CHAT_MODEL
        value: "meta-llama/llama-4-scout-17b-16e-instruct"
      - key: REDIS_URL
        sync: false          # optional — leave blank to use in-memory fallback
                             # set to your Redis connection URL if using Render Redis

# Optional: Add a Render Redis instance for persistent session memory
# Uncomment the block below to provision a Redis instance automatically:
# databases:
#   - name: rag-grok-redis
#     type: redis
#     plan: free
#     ipAllowList: []        # allow all — restrict in production
